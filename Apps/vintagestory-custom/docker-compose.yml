name: vs-custom-josh
services:
  vintagestory:
    image: ghcr.io/joshevans-weber/vs-custom:latest
    container_name: vs-server
    restart: always
    ports:
      - "${SERVER_PORT:-42420}:42420/udp"
      - "7681:7681"
    volumes:
      - /DATA/AppData/vintagestory/data:/vintagestory/data
    environment:
      # --- System & Permissions ---
      - UID_NUMBER=${UID_NUMBER:-1100}
      - GID_NUMBER=${GID_NUMBER:-1100}
      - DOTNET_GCHeapHardLimit=${DOTNET_GCHeapHardLimit:-0x280000000}
      - DOTNET_gcServer=${DOTNET_gcServer:-1}
      - DOTNET_VERSION=${DOTNET_VERSION:-8.0}
      
      # --- Server Identity ---
      - SERVER_NAME=${SERVER_NAME:-Vintage Story Server}
      - WELCOME_MESSAGE=${WELCOME_MESSAGE:-Welcome {0}, may you survive well and prosper}
      - SERVER_DESCRIPTION=${SERVER_DESCRIPTION}
      - MAX_CLIENTS=${MAX_CLIENTS:-16}
      - SERVER_PASSWORD=${SERVER_PASSWORD}
      - ADVERTISE_SERVER=${ADVERTISE_SERVER:-false}
      - ONLY_WHITELISTED=${ONLY_WHITELISTED:-false}
      - ADMIN_USERNAME=${ADMIN_USERNAME}
      - DEFAULT_ROLE_CODE=${DEFAULT_ROLE_CODE:-suplayer}
      
      # --- Gameplay Logic ---
      - WORLD_NAME=${WORLD_NAME:-Vintage Story World}
      - WORLD_SEED=${WORLD_SEED}
      - PLAY_STYLE=${PLAY_STYLE:-surviveandbuild}
      - PASS_TIME_WHEN_EMPTY=${PASS_TIME_WHEN_EMPTY:-false}
      - ALLOW_CREATIVE_MODE=${ALLOW_CREATIVE_MODE:-true}
      - ALLOW_PVP=${ALLOW_PVP:-true}
      - ALLOW_FALLING_BLOCKS=${ALLOW_FALLING_BLOCKS:-true}
      - ALLOW_FIRE_SPREAD=${ALLOW_FIRE_SPREAD:-true}
      - ANTI_ABUSE=${ANTI_ABUSE:-Off}
      
      # --- World Config (The "June" Settings) ---
      - WORLDCONFIG_GAME_MODE=${WORLDCONFIG_GAME_MODE:-survival}
      - WORLDCONFIG_MOVE_SPEED=${WORLDCONFIG_MOVE_SPEED:-1.5}
      - WORLDCONFIG_PLAYER_HEALTH=${WORLDCONFIG_PLAYER_HEALTH:-15}
      - WORLDCONFIG_HUNGER_SPEED=${WORLDCONFIG_HUNGER_SPEED:-1}
      - WORLDCONFIG_FOOD_SPOIL=${WORLDCONFIG_FOOD_SPOIL:-1}
      - WORLDCONFIG_TOOL_DURABILITY=${WORLDCONFIG_TOOL_DURABILITY:-1}
      - WORLDCONFIG_SAPLING_GROWTH=${WORLDCONFIG_SAPLING_GROWTH:-1}
      - WORLDCONFIG_CREATURE_HOSTILITY=${WORLDCONFIG_CREATURE_HOSTILITY:-aggressive}
      - WORLDCONFIG_DEATH_PUNISHMENT=${WORLDCONFIG_DEATH_PUNISHMENT:-drop}
      - WORLDCONFIG_TEMPORAL_STORMS=${WORLDCONFIG_TEMPORAL_STORMS:-sometimes}
      - WORLDCONFIG_TEMPORAL_RIFTS=${WORLDCONFIG_TEMPORAL_RIFTS:-visible}
      - WORLDCONFIG_ALLOW_MAP=${WORLDCONFIG_ALLOW_MAP:-true}
      - WORLDCONFIG_ALLOW_COORDINATES=${WORLDCONFIG_ALLOW_COORDINATES:-true}
      - WORLDCONFIG_WORLD_CLIMATE=${WORLDCONFIG_WORLD_CLIMATE:-realistic}
      
      # --- Internal Paths ---
      - DATAPATH=/vintagestory/data
      - HOMEPATH=/vintagestory
      - VSPATH=/vintagestory/server
      - SAVE_FILE_LOCATION=/vintagestory/data/Saves/default.vcdbs
      
      # --- Secrets & Extras ---
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    stdin_open: true
    tty: true

x-casaos:
  architectures:
    - amd64
  main: vintagestory
  icon: https://wiki.vintagestory.at/images/8/8a/Gamelogo-vintagestory.png
  title:
    en_us: "Vintage Story (Josh's Cloud)"
  description:
    en_us: "Full server build. All gameplay and system variables exposed."
  port_map: "7681"
  developer: "JoshEvans-Weber"
  author: "Josh"
  category: "Game"
  envs:
    - container: WORLD_NAME
      description: { en_us: "World Name" }
    - container: WORLDCONFIG_MOVE_SPEED
      description: { en_us: "Movement Speed (Default 1.5)" }
    - container: WORLDCONFIG_TEMPORAL_STORMS
      description: { en_us: "Storm Frequency (off, rare, sometimes, often)" }
    - container: OPENAI_API_KEY
      description: { en_us: "OpenAI API Key" }
